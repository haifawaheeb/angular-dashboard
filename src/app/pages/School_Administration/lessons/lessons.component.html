<div class="page-container">

  <!-- Top Bar -->
  <div class="top-bar">
    <button class="btn-new" (click)="openDialog()">ุฏุฑุณ ุฌุฏูุฏ</button>
  </div>

  <!-- Filter -->
  <div class="filter-bar">
    <input
      type="text"
      [(ngModel)]="search"
      (input)="applyFilter()"
      placeholder="ุจุญุซ ุนู ุงูุฏุฑุณ..."
    >
  </div>

  <!-- Table -->
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <!-- <th>#</th> -->
          <th>ุนููุงู ุงูุฏุฑุณ</th>
          <th>ููุน ุงูุฏุฑุณ</th>
          <th>ุงููุตู</th>
          <th>ุงูุชุฑุชูุจ</th>
          <th>ููุดูุฑุ</th>
          <th>ุชุนุฏูู</th>
          <th>ุญุฐู</th>
        </tr>
      </thead>

      <tbody>
        @for (l of filteredLessons; track l.id) {
        <tr>
          <!-- <td>{{ l.id }}</td> -->
          <td>{{ l.title_ar }}</td>
          <td>{{ l.lesson_type }}</td>
          <td>{{ l.description_ar }}</td>
          <td>{{ l.order_index }}</td>
          <td>{{ l.is_published ? 'ูุนู' : 'ูุง' }}</td>
          <td>
            <button (click)="editLesson(l)" class="icon-btn-table edit">โ</button>
          </td>
          <td>
            <button (click)="deleteLesson(l.id)" class="icon-btn-table delete">๐</button>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
</div>

<!-- Dialog -->
@if (isDialogOpen) {
<div class="dialog-overlay"  (click)="closeDialog()">
  <div class="dialog-box" (click)="$event.stopPropagation()">
 <div class="dialog-header">
    <h3>{{ dialogTitle }}</h3></div>
    <form [formGroup]="form">
<div class="form-grid">

        <div class="form-col">
      <label>ุงูููุฑุณ</label>
      <select formControlName="course">
  <option value="">-- ุงุฎุชุฑ ุงูููุฑุณ --</option>
  @for (c of courses; track c.id) {
    <option [value]="c.id">
      {{ c.subject_name }} - {{ c.grade_name }}
    </option>
  }
</select>

      <label>ุงูุนููุงู (ุนุฑุจู)</label>
      <input formControlName="title_ar">

      <label>ุงูุนููุงู (ุฅูุฌููุฒู)</label>
      <input formControlName="title_en">

      <label>ุงููุตู (ุนุฑุจู)</label>
      <textarea formControlName="description_ar"></textarea>
</div>

<div class="form-col">
      <label>ุงููุตู (ุฅูุฌููุฒู)</label>
      <textarea formControlName="description_en"></textarea>


      <label>ููุน ุงูุฏุฑุณ</label>
      <select formControlName="lesson_type">
        <option value="interactive">ุชูุงุนูู</option>
        <option value="video">ููุฏูู</option>
        <option value="text">ูุตู</option>
      </select>

<div class="form-col">
      <label>ุงูุชุฑุชูุจ</label>
      <input type="number" formControlName="order_index">
</div>
      <label>ููุดูุฑุ</label>
      <select formControlName="is_published">
        <option [value]="true">ูุนู</option>
        <option [value]="false">ูุง</option>
      </select>
      </div>
</div>
      <div class="footer-buttons">
        <button type="button" (click)="save()" class="btn-save">๐พ ุญูุธ</button>
        <button type="button" (click)="closeDialog()" class="btn-exit">โ ุฎุฑูุฌ</button>
      </div>

    </form>
  </div>
</div>
}
