<div class="page-container">

  <div class="top-bar">
    <button class="btn-new" (click)="openDialog()">ุฌุฏูุฏ</button>
  </div>

  <div class="filter-bar">
    <input type="text" [(ngModel)]="search" (input)="applyFilter()" placeholder="ุจุญุซ ...">
  </div>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <!-- <th>#</th> -->
          <th>ุงููุงุฏุฉ</th>
          <th>ุงูุตู</th>
          <th>ุงููุนูู</th>
          <th>ุงูุณูุฉ</th>
          <th>ุงูุญุงูุฉ</th>
          <th>ุชุนุฏูู</th>
          <th>ุญุฐู</th>
        </tr>
      </thead>

      <tbody>
        @for (c of filtered; track c.id) {
        <tr>
          <!-- <td>{{ c.id }}</td> -->
          <td>{{ c.subject_name || '-' }}</td>
          <td>{{ c.grade_name || '-' }}</td>
          <td>{{ c.main_teacher_name || '-' }}</td>
          <td>{{ c.academic_year }}</td>
          <td>{{ c.is_active ? 'ูุดุท' : 'ุบูุฑ ูุดุท' }}</td>

          <td>
            <button (click)="edit(c)" class="icon-btn-table edit">โ</button>
          </td>
          <td>
            <button (click)="delete(c.id)" class="icon-btn-table delete">๐</button>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
</div>

@if (isDialogOpen) {
<div class="dialog-overlay" (click)="closeDialog()">
  <div class="dialog-box" (click)="$event.stopPropagation()">

    <div class="dialog-header">
      <h3>{{ dialogTitle }}</h3>
      <button (click)="closeDialog()">โ</button>
    </div>

    <form [formGroup]="form" class="dialog-body">

      <div class="form-grid">

        <div class="form-col">
          <label>ุงููุงุฏุฉ</label>
          <select formControlName="subject">
            <option value="">-- ุงุฎุชุฑ ุงููุงุฏุฉ --</option>
            @for (s of subjects; track s.id) {
              <option [value]="s.id">{{ s.name_ar }}</option>
            }
          </select>
        </div>

        <div class="form-col">
          <label>ุงูุตู</label>
          <select formControlName="grade">
            <option value="">-- ุงุฎุชุฑ ุงูุตู --</option>
            @for (g of grades; track g.id) {
              <option [value]="g.id">{{ g.name_ar }}</option>
            }
          </select>
        </div>

        <div class="form-col">
          <label>ุงููุนูู</label>
          <select formControlName="main_teacher">
            <option value="">-- ุจุฏูู ูุนูู --</option>
            @for (t of teachers; track t.id) {
              <option [value]="t.id">{{ t.full_name }}</option>
            }
          </select>
        </div>

        <div class="form-col">
          <label>ุงูุณูุฉ ุงูุฏุฑุงุณูุฉ</label>
          <input type="text" formControlName="academic_year" placeholder="2020-2021">
        </div>

        <div class="form-col">
          <label>ุงูุญุงูุฉ</label>
          <select formControlName="is_active">
            <option [value]="true">ูุดุท</option>
            <option [value]="false">ุบูุฑ ูุดุท</option>
          </select>
        </div>

      </div>

      <div class="footer-buttons">
        <button type="button" (click)="save()"  class="btn-save">๐พ ุญูุธ</button>
        <button type="button" (click)="closeDialog()" class="btn-exit">โ ุฎุฑูุฌ</button>
      </div>

    </form>
  </div>
</div>
}
